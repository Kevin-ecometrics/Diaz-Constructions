---
import Stats1 from "@assets/Stats";
import Stats2 from "@assets/Stats2";
import Stats3 from "@assets/Stats3";
---

<section class="py-16" id="stats-section">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-7xl mx-auto">
      <!-- Card 1 - Proyectos -->
      <div
        class="bg-white rounded-lg shadow-lg p-8 text-start hover:shadow-xl transition-shadow duration-300"
      >
        <div class="flex justify-start mb-6">
          <div
            class="w-16 h-16 bg-orange-100 rounded-lg flex items-center justify-center"
          >
            <Stats1 />
          </div>
        </div>
        <div class="mb-4">
          <span
            class="text-5xl font-bold text-gray-900 counter"
            data-target="75">0</span
          >
          <span class="text-3xl font-bold text-background">+</span>
        </div>
        <p class="text-gray-600 leading-relaxed">
          Clients from San Francisco, the bay area and surroundings had trusted
          our professional services
        </p>
      </div>

      <!-- Card 2 - Satisfacción -->
      <div
        class="bg-white rounded-lg shadow-lg p-8 text-start hover:shadow-xl transition-shadow duration-300"
      >
        <div class="flex justify-start mb-6">
          <div
            class="w-16 h-16 bg-orange-100 rounded-lg flex items-center justify-center"
          >
            <Stats2 />
          </div>
        </div>
        <div class="mb-4">
          <span
            class="text-5xl font-bold text-gray-900 counter"
            data-target="120">0</span
          >
          <span class="text-3xl font-bold text-background">+</span>
        </div>
        <p class="text-gray-600 leading-relaxed">
          Projects done from construction & remodeling new buildings, ADU´S,
          bathroom, kitchens, landscape, hardscape, outdoors flooring with
          Flawless Results for Residential and Commercial Clients.
        </p>
      </div>

      <!-- Card 3 - Crecimiento -->
      <div
        class="bg-white rounded-lg shadow-lg p-8 text-start hover:shadow-xl transition-shadow duration-300"
      >
        <div class="flex justify-start mb-6">
          <div
            class="w-16 h-16 bg-orange-100 rounded-lg flex items-center justify-center"
          >
            <Stats3 />
          </div>
        </div>
        <div class="mb-4">
          <span
            class="text-5xl font-bold text-gray-900 counter"
            data-target="47">0</span
          >
          <span class="text-3xl font-bold text-background"
            >+ Client Reviews
          </span>
        </div>
        <p class="text-gray-600 leading-relaxed">
          As a family own company, we take pride in providing the best
          experience for our customers. Whether it is a new or returning client,
          a small or big project, you can always count on our best foot forward.
        </p>
      </div>
    </div>
  </div>
</section>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  // Registrar ScrollTrigger
  gsap.registerPlugin(ScrollTrigger);

  // Función para animar los contadores
  function animateCounters() {
    const counters = document.querySelectorAll(".counter");

    counters.forEach((counter) => {
      const target = parseInt(
        (counter as HTMLElement).dataset.target as string
      );

      gsap.fromTo(
        counter,
        {
          textContent: 0,
        },
        {
          textContent: target,
          duration: 2,
          ease: "power2.out",
          snap: { textContent: 1 },
          stagger: 0.2,
          onUpdate: function () {
            // Formatear números grandes con comas
            const currentValue = Math.ceil(this.targets()[0].textContent);
            if (currentValue >= 1000) {
              counter.textContent = currentValue.toLocaleString();
            } else {
              counter.textContent = currentValue.toString();
            }
          },
        }
      );
    });
  }

  // Animar las tarjetas al entrar en viewport
  gsap.fromTo(
    ".bg-white",
    {
      y: 50,
      opacity: 0,
      scale: 0.95,
    },
    {
      y: 0,
      opacity: 1,
      scale: 1,
      duration: 0.8,
      ease: "back.out(1.7)",
      stagger: 0.2,
      scrollTrigger: {
        trigger: "#stats-section",
        start: "top 80%",
        end: "bottom 20%",
        onEnter: () => {
          // Iniciar animación de contadores cuando las tarjetas aparezcan
          setTimeout(animateCounters, 500);
        },
      },
    }
  );

  // Animar iconos con rotación y escala
  gsap.fromTo(
    ".w-16.h-16 svg",
    {
      rotation: -180,
      scale: 0,
    },
    {
      rotation: 0,
      scale: 1,
      duration: 1,
      ease: "elastic.out(1, 0.3)",
      stagger: 0.1,
      scrollTrigger: {
        trigger: "#stats-section",
        start: "top 80%",
      },
    }
  );
</script>

<style>
  /* Estilos base para las animaciones */
  .counter {
    display: inline-block;
  }

  .bg-white {
    transform: translateY(50px);
    opacity: 0;
  }

  .w-16.h-16 svg {
    transform: rotate(-180deg) scale(0);
  }

  /* Efectos hover mejorados */
  .bg-white:hover {
    transform: translateY(-8px) !important;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1) !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  }

  .w-16.h-16:hover {
    transform: scale(1.1) rotate(5deg);
    transition: all 0.3s ease;
  }

  /* Animación de pulso para los iconos */
  @keyframes pulse-orange {
    0%,
    100% {
      box-shadow: 0 0 0 0 rgba(249, 115, 22, 0.4);
    }
    50% {
      box-shadow: 0 0 0 10px rgba(249, 115, 22, 0);
    }
  }

  .w-16.h-16 {
    animation: pulse-orange 3s infinite;
  }
</style>
